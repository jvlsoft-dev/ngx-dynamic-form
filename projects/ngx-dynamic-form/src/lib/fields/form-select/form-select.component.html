<div *ngIf="!!group.get(config.name)" [formGroup]="group" [hidden]="config.fieldType === 'hidden'">
    <div class="row">
        <div id="ngSelect" >
            <!-- Label -->
            <form-label *ngIf="!!config.label" [config]="config"></form-label>
            <!-- Select -->
            <ng-select #selectItem class="select"
                (change)="config.options?.onChange?.emit(selectItem.selectedValues)"
                (scrollToEnd)="onScroll(selectItem.searchTerm)" 
                (search)="onSearch()"
                [bindLabel]="config.options?.bindLabel || 'name'" 
                [bindValue]="config.options?.bindValue || 'id'"
                [ngClass]="{
                           'is-invalid': formService.isControlInvalid(group, config.name),
                           'is-valid': formService.isControlValid(group, config.name),
                       }" 
                [clearable]="config.options?.clearable ?? true" 
                [formControlName]="config.name"
                [groupBy]="config.options?.groupBy || ''" 
                [items]="items || []"
                [loading]="(loading$ | async) ?? false" 
                [maxSelectedItems]="config.options?.maxSelectedItems || maxNumber"
                [multiple]="!!config.options?.multiple" 
                [placeholder]="config.placeholder || ''"
                [readonly]="config.readonly ?? false" 
                [searchable]="config.options?.searchable ?? true"
                [typeahead]="input$" 
                [virtualScroll]="config.options?.dynamic ?? false" 
                appendTo=".select">

                <ng-template [ngIf]="config.options?.color">
                    <ng-template let-item="item" ng-label-tmp>
                        <div [ngStyle]="{'background': item}" class="circle-div"></div>
                    </ng-template>
                </ng-template>

                <ng-template let-item="item" ng-option-tmp>
                    <div *ngIf="config.options?.color" [ngStyle]="{'background': item}" class="circle-div"></div>
                    <div *ngIf="!config.options?.color"
                        [ngStyle]="{'color': item[config.options?.bindColor || 'color']}" style="white-space: normal">
                        {{item[config.options?.bindLabel || 'name'] || item}}
                    </div>
                </ng-template>

            </ng-select>
            <!-- Required validation -->
            <div *ngIf="!(formService.isSubmitted$ | async) && formService.controlHasError(group, config.name, 'required')"
                class="invalid-feedback">
                <!-- TODO: Language constants -->
                Este campo es requerido
            </div>
            <span *ngIf="!!config.helperText" [innerHTML]="config.helperText" class="form-text text-muted">
            </span>
        </div>
    </div>
</div>